--[[
    Script: 99 Noites na Floresta - Ultimate Mod Menu
    Versão: 2.0
    Funcionalidades:
    - Interface Futurista e Elegante
    - Sistema de Chave de Acesso Aprimorado
    - Botão 'C' no canto da tela para abrir/fechar
    - Comandos Funcionais para o jogo
]]

-- CONFIGURAÇÕES
local ChaveCorreta = "F8E2D1C7B6A5"
local TituloDoMenu = "99 Noites na Floresta"

-- SERVIÇOS E VARIÁVEIS DO JOGO
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- CRIAÇÃO DA INTERFACE PRINCIPAL
local Library = {}

function Library:CriarInterface()
    -- TELA DE CARREGAMENTO
    local loadingScreen = Instance.new("ScreenGui")
    loadingScreen.Name = "LoadingScreen"
    loadingScreen.Parent = PlayerGui
    loadingScreen.ZIndexBehavior = Enum.ZIndexBehavior.Global

    local background = Instance.new("Frame")
    background.Parent = loadingScreen
    background.BackgroundColor3 = Color3.fromRGB(12, 12, 18)
    background.Size = UDim2.new(1, 0, 1, 0)

    local title = Instance.new("TextLabel")
    title.Parent = background
    title.BackgroundColor3 = Color3.new(1, 1, 1)
    title.BackgroundTransparency = 1
    title.Position = UDim2.new(0.5, -200, 0.5, -50)
    title.Size = UDim2.new(0, 400, 0, 50)
    title.Font = Enum.Font.Code
    title.Text = "INICIANDO SCRIPT..."
    title.TextColor3 = Color3.fromRGB(0, 255, 255)
    title.TextScaled = true
    Instance.new("UICorner", title).CornerRadius = UDim.new(0, 8)

    wait(3)
    loadingScreen:Destroy()

    -- TELA DA CHAVE DE ACESSO ELEGANTE
    local keyAuthScreen = Instance.new("ScreenGui")
    keyAuthScreen.Name = "KeyAuthScreen"
    keyAuthScreen.Parent = PlayerGui
    keyAuthScreen.ZIndexBehavior = Enum.ZIndexBehavior.Global

    local keyFrame = Instance.new("Frame")
    keyFrame.Name = "KeyFrame"
    keyFrame.Parent = keyAuthScreen
    keyFrame.BackgroundColor3 = Color3.fromRGB(20, 22, 30)
    keyFrame.BorderColor3 = Color3.fromRGB(0, 180, 255)
    keyFrame.BorderSizePixel = 1
    keyFrame.Size = UDim2.new(0, 450, 0, 220)
    keyFrame.Position = UDim2.new(0.5, -225, 0.5, -110)
    keyFrame.Active = true
    keyFrame.Draggable = true
    Instance.new("UICorner", keyFrame).CornerRadius = UDim.new(0, 12)

    local keyTitle = Instance.new("TextLabel")
    keyTitle.Name = "KeyTitle"
    keyTitle.Parent = keyFrame
    keyTitle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    keyTitle.BackgroundTransparency = 1
    keyTitle.Size = UDim2.new(1, 0, 0, 40)
    keyTitle.Position = UDim2.new(0, 0, 0.05, 0)
    keyTitle.Font = Enum.Font.Code
    keyTitle.Text = "AUTENTICAÇÃO NECESSÁRIA"
    keyTitle.TextColor3 = Color3.fromRGB(0, 225, 255)
    keyTitle.TextSize = 24

    local keyTextBox = Instance.new("TextBox")
    keyTextBox.Name = "KeyTextBox"
    keyTextBox.Parent = keyFrame
    keyTextBox.BackgroundColor3 = Color3.fromRGB(15, 17, 25)
    keyTextBox.BorderColor3 = Color3.fromRGB(0, 180, 255)
    keyTextBox.Position = UDim2.new(0.1, 0, 0.4, 0)
    keyTextBox.Size = UDim2.new(0.8, 0, 0, 50)
    keyTextBox.Font = Enum.Font.SourceSans
    keyTextBox.PlaceholderText = "Sua Chave de 12 Dígitos"
    keyTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    keyTextBox.TextScaled = true
    Instance.new("UICorner", keyTextBox).CornerRadius = UDim.new(0, 8)

    local verifyButton = Instance.new("TextButton")
    verifyButton.Name = "VerifyButton"
    verifyButton.Parent = keyFrame
    verifyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 150)
    verifyButton.BorderColor3 = Color3.fromRGB(0, 255, 255)
    verifyButton.Position = UDim2.new(0.3, 0, 0.75, 0)
    verifyButton.Size = UDim2.new(0.4, 0, 0, 40)
    verifyButton.Font = Enum.Font.Code
    verifyButton.Text = "ENTRAR"
    verifyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    verifyButton.TextScaled = true
    Instance.new("UICorner", verifyButton).CornerRadius = UDim.new(0, 8)

    local errorMessage = Instance.new("TextLabel")
    errorMessage.Name = "ErrorMessage"
    errorMessage.Parent = keyFrame
    errorMessage.BackgroundTransparency = 1
    errorMessage.Size = UDim2.new(1, 0, 0, 20)
    errorMessage.Position = UDim2.new(0, 0, 0.6, 0)
    errorMessage.Font = Enum.Font.SourceSansBold
    errorMessage.Text = ""
    errorMessage.TextColor3 = Color3.fromRGB(255, 50, 50)
    errorMessage.Visible = false

    -- MOD MENU PRINCIPAL
    local modMenuScreen = Instance.new("ScreenGui")
    modMenuScreen.Name = "ModMenu"
    modMenuScreen.Enabled = false
    modMenuScreen.Parent = PlayerGui
    modMenuScreen.ZIndexBehavior = Enum.ZIndexBehavior.Global

    local mainMenu = Instance.new("Frame")
    mainMenu.Name = "MainMenu"
    mainMenu.Parent = modMenuScreen
    mainMenu.BackgroundColor3 = Color3.fromRGB(20, 22, 30)
    mainMenu.BorderColor3 = Color3.fromRGB(0, 180, 255)
    mainMenu.BorderSizePixel = 1
    mainMenu.Size = UDim2.new(0, 600, 0, 400)
    mainMenu.Position = UDim2.new(0.5, -300, 0.5, -200)
    mainMenu.Active = true
    mainMenu.Draggable = true
    Instance.new("UICorner", mainMenu).CornerRadius = UDim.new(0, 12)

    local header = Instance.new("Frame")
    header.Name = "Header"
    header.Parent = mainMenu
    header.BackgroundColor3 = Color3.fromRGB(25, 28, 40)
    header.Size = UDim2.new(1, 0, 0, 40)
    Instance.new("UICorner", header).CornerRadius = UDim.new(0, 12)

    local menuTitle = Instance.new("TextLabel")
    menuTitle.Name = "MenuTitle"
    menuTitle.Parent = header
    menuTitle.BackgroundTransparency = 1
    menuTitle.Size = UDim2.new(1, 0, 1, 0)
    menuTitle.Font = Enum.Font.Code
    menuTitle.Text = TituloDoMenu
    menuTitle.TextColor3 = Color3.fromRGB(0, 225, 255)
    menuTitle.TextScaled = true

    -- BOTÃO PARA ABRIR/FECHAR NO CANTO DA TELA
    local toggleButton = Instance.new("TextButton")
    toggleButton.Name = "ToggleButton"
    toggleButton.Parent = PlayerGui
    toggleButton.BackgroundColor3 = Color3.fromRGB(20, 22, 30)
    toggleButton.BorderColor3 = Color3.fromRGB(0, 180, 255)
    toggleButton.Size = UDim2.new(0, 40, 0, 40)
    toggleButton.Position = UDim2.new(1, -50, 0, 10)
    toggleButton.Font = Enum.Font.Code
    toggleButton.Text = "C"
    toggleButton.TextColor3 = Color3.fromRGB(0, 225, 255)
    toggleButton.TextSize = 24
    toggleButton.Visible = false
    Instance.new("UICorner", toggleButton).CornerRadius = UDim.new(0, 8)

    -- ÁREA DE COMANDOS
    local commandsContainer = Instance.new("ScrollingFrame")
    commandsContainer.Parent = mainMenu
    commandsContainer.Size = UDim2.new(0.95, 0, 0.85, 0)
    commandsContainer.Position = UDim2.new(0.025, 0, 0.12, 0)
    commandsContainer.BackgroundColor3 = Color3.fromRGB(20, 22, 30)
    commandsContainer.BorderSizePixel = 0
    commandsContainer.CanvasSize = UDim2.new(0, 0, 2, 0) -- Ajustar se tiver muitos botões

    local commandLayout = Instance.new("UIGridLayout")
    commandLayout.Parent = commandsContainer
    commandLayout.CellPadding = UDim2.new(0.02, 0, 0.02, 0)
    commandLayout.CellSize = UDim2.new(0.45, 0, 0, 50)
    commandLayout.SortOrder = Enum.SortOrder.LayoutOrder

    -- FUNÇÃO PARA CRIAR BOTÕES DE COMANDO
    function Library:CreateButton(name, callback)
        local button = Instance.new("TextButton")
        button.Name = name
        button.Parent = commandsContainer
        button.BackgroundColor3 = Color3.fromRGB(0, 150, 150)
        button.BorderColor3 = Color3.fromRGB(0, 255, 255)
        button.Font = Enum.Font.Code
        button.Text = name
        button.TextColor3 = Color3.fromRGB(255, 255, 255)
        button.TextScaled = true
        Instance.new("UICorner", button).CornerRadius = UDim.new(0, 8)
        button.MouseButton1Click:Connect(callback)
        return button
    end

    -- COMANDOS DO JOGO
    Library:CreateButton("Vencer a Noite", function()
        ReplicatedStorage.DefaultRemotes.NightEvent:FireServer("Win")
    end)
    
    Library:CreateButton("Bateria Infinita", function()
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Flashlight") then
            LocalPlayer.Character.Flashlight.Battery.Value = 9e9
        end
    end)

    Library:CreateButton("Correr Infinito", function()
        LocalPlayer.PlayerValues.Stamina.Value = LocalPlayer.PlayerValues.MaxStamina.Value
    end)

    Library:CreateButton("Modo Deus", function()
        LocalPlayer.Character.Humanoid.MaxHealth = math.huge
        LocalPlayer.Character.Humanoid.Health = math.huge
    end)
    
    Library:CreateButton("Aumentar Velocidade", function()
        LocalPlayer.Character.Humanoid.WalkSpeed = 50
    end)

    Library:CreateButton("Resetar Velocidade", function()
        LocalPlayer.Character.Humanoid.WalkSpeed = 16
    end)

    Library:CreateButton("Teleportar para Loja", function()
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-16, 5, 21)
    end)

    Library:CreateButton("Teleportar para Cabana", function()
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(205, 133, -342)
    end)

    -- LÓGICA DO SCRIPT
    verifyButton.MouseButton1Click:Connect(function()
        if keyTextBox.Text == ChaveCorreta then
            keyAuthScreen:Destroy()
            modMenuScreen.Enabled = false
            toggleButton.Visible = true
        else
            errorMessage.Text = "ERRO: Chave Inválida!"
            errorMessage.Visible = true
            wait(2)
            errorMessage.Visible = false
        end
    end)
    
    local function toggleMenu()
        modMenuScreen.Enabled = not modMenuScreen.Enabled
    end

    toggleButton.MouseButton1Click:Connect(toggleMenu)
    UserInputService.InputBegan:Connect(function(input, gameProcessedEvent)
        if gameProcessedEvent then return end
        if input.KeyCode == Enum.KeyCode.C then
            toggleMenu()
        end
    end)
end

-- INICIAR O SCRIPT
Library:CriarInterface()